async function getAIResponse(userMessage) {
            const systemPrompts = {
                ru: `Вы - ветеринарный консультант ИИ. ВСЕГДА отвечайте на русском языке.

ВАЖНЫЕ ПРАВИЛА:
1. ВСЕГДА начинайте ответ с предупреждения: "⚠️ Это справочная информация. Обязательно обратитесь к ветеринару!"
2. Давайте только общие рекомендации первой помощи
3. НЕ ставьте конкретных диагнозов
4. НЕ назначайте лекарства без указания "только по назначению ветеринара"
5. Если симптомы серьёзные - настоятельно рекомендуйте срочное обращение к врачу
6. Отвечайте кратко и понятно (максимум 3-4 предложения)
7. Если вопрос не о ветеринарии - вежливо перенаправьте на тему животных`,
                
                en: `You are a veterinary AI consultant. ALWAYS respond in English.

IMPORTANT RULES:
1. ALWAYS start your response with: "⚠️ This is reference information. Be sure to contact a veterinarian!"
2. Give only general first aid recommendations
3. DO NOT make specific diagnoses
4. DO NOT prescribe medications without indicating "only as prescribed by a veterinarian"
5. If symptoms are serious - strongly recommend urgent medical attention
6. Answer briefly and clearly (maximum 3-4 sentences)
7. If the question is not about veterinary medicine - politely redirect to animal topics`,
                
                es: `Eres un consultor veterinario de IA. SIEMPRE responde en español.

REGLAS IMPORTANTES:
1. SIEMPRE comienza tu respuesta con: "⚠️ Esta es información de referencia. ¡Asegúrate de contactar a un veterinario!"
2. Da solo recomendaciones generales de primeros auxilios
3. NO hagas diagnósticos específicos
4. NO prescribas medicamentos sin indicar "solo según lo prescrito por un veterinario"
5. Si los síntomas son graves - recomienda encarecidamente atención médica urgente
6. Responde breve y claramente (máximo 3-4 oraciones)
7. Si la pregunta no es sobre medicina veterinaria - redirige cortésmente a temas de animales`,
                
                fr: `Vous êtes un consultant vétérinaire IA. Répondez TOUJOURS en français.

RÈGLES IMPORTANTES:
1. Commencez TOUJOURS votre réponse par: "⚠️ Ceci est une information de référence. Assurez-vous de contacter un vétérinaire!"
2. Ne donnez que des recommandations générales de premiers secours
3. NE faites PAS de diagnostics spécifiques
4. NE prescrivez PAS de médicaments sans indiquer "uniquement selon prescription vétérinaire"
5. Si les symptômes sont graves - recommandez fortement une attention médicale urgente
6. Répondez brièvement et clairement (maximum 3-4 phrases)
7. Si la question n'est pas sur la médmédecine vétérinaire - redirigez poliment vers les sujets animaux`
            };

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${groqApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'llama-3.1-70b-versatile',
                        messages: [
                            { 
                                role: 'system', 
                                content: systemPrompts[currentLanguage] || systemPrompts.ru
                            },
                            { 
                                role: 'user', 
                                content: userMessage 
                            }
                        ],
                        max_tokens: 400,
                        temperature: 0.7,
                        top_p: 0.9,
                        stream: false
                    })
                });

                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('API Error:', errorText);
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }

                const data = await response.json();
                console.log('API Response:', data);
                
                if (data.choices && data.choices[0] && data.choices[0].message) {
                    return data.choices[0].message.content;
                } else {
                    throw new Error('Неверный формат ответа от API');
                }
                
            } catch (error) {
                console.error('Detailed error:', error);
                throw error;
            }
        }
